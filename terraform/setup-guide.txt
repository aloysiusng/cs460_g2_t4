1. At aws console, create an S3 bucket to store our tf state
store the bucket name somewhere as AWS_BUCKET_NAME

3. At aws console, create an IAM identity provider:
a. For Provider type, select OpenID Connect.
b. For Provider URL, enter https://token.actions.githubusercontent.com
c. Click on Get thumbprint to get the thumbprint of the provider
d. For Audience, enter sts.amazonaws.com

4. create an iam policy to allow github to write on S3
{
	"Version": "2012-10-17",
	"Statement": [
		{
			"Effect": "Allow",
			"Action": "s3:ListBucket",
			"Resource": "arn:aws:s3:::<your bucket>"
		},
		{
			"Effect": "Allow",
			"Action": [
				"s3:PutObject",
				"s3:GetObject"
			],
			"Resource": "arn:aws:s3:::<your bucket>/*"
		}
	]
}


5. At aws console, create an IAM role:
a. For Trusted entity, select Web identity.
b. github organization: put user name of your github account
c. github repo: put the name of the repo
d. github branch: put the name of the branch 
e. attach the policy created in the previous step

6. copy the ARN as AWS ROLE

At github > settings > security > secrets and variables > actions 
select new repository secret and add the following secrets:
- AWS_REGION
- AWS_ROLE 
- AWS_BUCKET_NAME 
- AWS_BUCKET_KEY_NAME (this is the name of the tfstate file)



Total manual creation:
IAM resources:
1x policy
1x role
1x provider

S3 resources:
1x bucket